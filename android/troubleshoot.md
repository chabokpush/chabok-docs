---
id: troubleshoot
title: عیب یابی اندروید
layout: android
permalink: android/troubleshoot.html
prev: features.html
---

## پوش‌نوتیفیکیشن

در این بخش به مشکلات متداول در پیام‌رسانی چابک خواهیم پرداخت.

### پوش نمی‌گیرم:

یکی از مشکلات متداول پوش ‌نوتیفیکشن و حتی نصب SDK، عدم دریافت پوش و پیام چابک است. منشا این مشکل در عدم راه‌اندازی و پیاده‌سازی صحیح چابک می‌باشد. در ادامه این مشکل را در دو حالت باز (Forground یا Background) و بسته (Terminated) بودن اپلیکیشن بررسی خواهیم کرد.


#### حالت Foreground یا Background اپلیکیشن

#### ۱- عدم ثبت موفق دستگاه کاربر

در صورتی که شما دستگاه را با `userId` که ثبت کردید در بخش مشترکین پنل مشاهده نکردید به نکات زیر توجه فرمایید:

- وی‌پی‌ان دستگاه باید حتما خاموش باشد.

- از تعیین درست محیط چابک (آزمایشی و عملیاتی) توسط متد `setDevelopment` اطمینان یابید.

- از وارد کردن صحیح اطلاعات حساب(`appId`, `APIKey`, `username`, `password`) اطمینان یابید. 


پس از بررسی نکات بالا دستگاه شما باید در بخش مشترکین پنل آمده باشد. علاوه بر آن شما می‌توانید از اتصال یا عدم اتصال دستگاه از مشاهده **نوار سبز رنگ** در بالای کارت مطلع شوید.

#### ۲- عدم عضویت کاربر در کانال ارسالی پیام

در صورت مشاهده دستگاه کاربر در بخش مشترکین پنل، از عضویت کاربر در کانالی که با آن پیام خود را ارسال می‌کنید اطمینان یابید. برای اینکه کانال‌هایی که کاربرتان در آن‌ها عضو هستند را مشاهده می‌کنید، می‌توانید روی آیکون ![کانال‌ها](http://uupload.ir/files/24jn_channels.png) در کارت هر دستگاه در بخش مشترکین پنل کلیک کنید.

![کانال‌ها](http://uupload.ir/files/vfd5_channelss.png
)

#### ۳- عدم ورود صحیح اطلاعات حساب (خطای internal server error)

در صورت دریافت خطای فوق در **logcat** یا **xcode log** از وارد کردن اطلاعات حساب (`appId`, `APIKey`, `username`, `password`) خود اطمینان یابید.

#### حالت Terminated اپلیکیشن

#### ۱- عدم پیاده‌سازی مراحل ۱ و ۲ بالا

در ابتدا از انجام صحیح مراحل اول و دوم در بالا یعنی ثبت موفق کاربر و عضویت در کانال ارسالی اطمینان یابید.

#### ۲- تنظیم غیر صحیح پوش‌نوتیفیکیشن برای هر پلتفرم

از وارد کردن صحیح اطلاعات دسترسی پوش‌نوتیفیکیشن در هر پلتفرم از [بخش تنظیمات پنل قسمت پلتفرم‌ها](https://doc.chabokpush.com/panel/settings.html#%D9%BE%D9%84%D8%AA%D9%81%D8%B1%D9%85%D9%87%D8%A7) اطمینان یابید.
در صورت مشاهده متن **غیرفعال** در کارت تنظیمات هر پلتفرم، دستگاه به بخش مشترکین اضافه نشده است. برای مثال اگر تنظیمات پوش‌نوتیفیکیشن اندروید را به درستی انجام داده باشید ولی دستگاه اندروید‌ به بخش مشترکین اضافه نشده باشد بر روی کارت تنظیمات پوش‌نوتیفیکیشن اندروید متن غیرفعال را مشاهده خواهید کرد.

#### ۳- یکسان نبودن `senderId` و `appId` در پنل و متد `init` 

دقت داشته باشید `senderId` و `appId`  که در پنل قرار داده‌اید با `senderId` و `appId` که در متد `init` چابک داده‌اید، یکسان باشد.

> `نکته:` ترکیب `APP_ID` و `SENDERID` به عنوان `YOUR_APP_ID` مورد استفاده قرار می‌گیرد.


#### ۴- عدم تعریف GCMReceiver 

 اطمینان یابید که [کد GcmReceiver در فایل AndroidManifes.xml قرار داده شده باشد.](https://doc.chabokpush.com/android/application-class.html#%DB%B3-%D8%AA%D8%B9%D8%B1%DB%8C%D9%81-%D8%B1%D8%B3%DB%8C%D9%88%D8%B1-gcmreceiver)
همچنین برای `YOUR_APPLICATION_PACKAGE_ID` حتما باید `bundleId` اپلیکیشن خود را قرار دهید.

#### ۵- عدم فراخوانی متد `init`

متد `init` چابک حتما باید در کلاس `application` و در متد `onCreate` در هر شرایطی فراخوانی شود و در صورت عدم فراخوانی متد فوق با خطای زیر مواجه خواهید شد.


```bash
AdpPushClient not initialized yet, please first call AdpPushClient.get with parameters
```

#### ۶- نسخه غیر صحیح **buildTool** و **play service**

نسخه buildTool و play service شما باید بدرستی انتخاب شود.

```bash
AdpPushClient not initialized yet, please first call AdpPushClient.get with parameters
```

#### ۷- باز نبودن اپلیکیشن

در پنل حساب کاربری خود در بخش پیام‌ها، **دایره زرد رنگ** به معنی **در صف بود پیام** شما می‌باشد و زمانی که کاربر به چابک متصل شود (اپ را باز کند) پیام را دریافت می‌کند. در بخش نوتیفیکیشن در صورت ارسال موفق پوش نوتیفیکیشن به سرور هر پلتفرم تیک سبز رنگ به همراه لوگو پلتفرم به معنی ارسال موفق پیام به سرور پلتفرم برای ارسال پوش‌نوتیفیکیشن است. همچنین در صورت مشاهد خطای **GONE** یا **device unregistered** به این معنی است که کاربر اپلیکیشن شما را حذف کرده است. در صورت مشاهده خطای **deviceTokenNotForTopic** به این معنی است که اطلاعات پلتفرم آی‌او‌اس که در پنل ما قرار داده‌اید با اپلیکیشنی روی دستگاه خودت نصب کرده‌اید همخوانی ندارد.


<Br>

## اعلان‌ها

در این بخش به مشکلات متداول مربوط به اعلان‌ها (Notifications) می‌پردازیم.

### اعلان‌ها نمایش داده نمی‌شوند:

یکی از مشکلات متداول اعلان‌ها عدم نمایش آن‌ها در دستگاه مخاطب است. در این قسمت به دلایل احتمالی این مشکل اشاره‌ خواهیم کرد.


#### ۱- اپلکیشن روی صفحه نمایش باز است
در حالت پیش‌فرض، اعلان‌ها در زمانی که اپلیکیشن روی دستگاه شما **باز** و **نمایان** است نشان داده نمی‌شوند.

#### ۲-  اپلیکیشن در حالت Force Stop است

در حالتی که اپلیکیشن شما در حالت **Force Stop** از سوی کاربر گذاشته شده باشد، اکثر رویداد‌ها از جمله دریافت پیام‌های GCM/FCM رخ نخواهد داد. به طور کلی یک اپلیکیشن در حالت‌های زیر می‌تواند **Force Stop** شود: 
- انتخاب گزینه **Force Stop** در صفحه Settings > Apps
- نگه‌ داشتن دکمه بازگشت روی بعضی گوشی‌ها 
- استفاده از یک برنامه برای بستن اپلیکیشن‌ها (App Killers)
- swipe اپلیکیشن حین دیباگ از دور (Remote Debugging)
- swipe اپلیکیشن از لیست Recent Apps در دستگاه‌های شیائومی
- به صورت خودکار از سوی بعضی برندهای گوشی برای بهینه سازی مصرف باتری. برای غیرفعال کردن آن قدم‌های زیر انجام دهید:

**سامسونگ:** غیرفعال کردن [battery usage optimization](https://android.gadgethacks.com/how-to/fix-delayed-notifications-your-galaxy-s8-s8-0177437/) 

**هواوی:** قدم اول: به settings > advanced settings > battery manager بروید و اپ را انتخاب کنید.

 قدم دوم: به settings > apps > advanced > ignore battery optimizations بروید و اپ را انتخاب کنید.

 قدم سوم: به settings > notification panel & status bar > notification center بروید و پس از انتخاب اپ، "allow notifications" و "priority display" را فعال کنید.

برای EMUI 5.0 / Android 7 پایین‌تر به Settings > Protected apps بروید و اپ خود را چک کنید. [راهنمای کامل](http://phandroid.com/2017/02/02/huawei-honor-emui-first-thing/)

**سونی:** آیکون باتری را بزنید و به Power Management > STAMINA mode > Apps active in standby بروید و اپ خود را اضافه کنید.

**ایسوس**: اپ خود را در Auto-start Manager چک کنید.

**وان‌پلاس**: به Settings > Battery > Battery Optimization > Application بروید و Don't Optimize را بزنید.

**اوپو**: به Settings > Security settings > Data saving بروید و اپ خود را فعال کنید.

**شیائومی**: به Security (App) > Permissions > Autostart بروید و اپ خود را فعال کنید.

**ردمی**: به Settings > Developer Options بروید و "memory optimization" را غیرفعال کنید. [راهنمای کامل](https://www.forbes.com/sites/bensin/2016/11/17/how-to-fix-push-notifications-on-xiaomis-miui-8-for-real/#384f6af97572)

#### ۳- گزینه دریافت پوش برای اپلیکیشن غیر‌فعال شده است
 تنظیمات نوتیفیکیشن در صفحه Settings > Apps را چک کنید. در صورت خاموش بودن گزینه نوتیفیکیشن، آن را فعال نمایید.


#### ۴- مشکل اتصال به اینترنت دارید
شبکه اینترنتی که به آن وصل هستید ممکن است اتصال شما به سرورهای گوگل یا اپل را بسته باشد. در این حالت می‌توانید قطع و وصل کردن اینترنت خود را امتحان کنید.
